```
Model residual = `r round(LA4_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA4_XO_FC_model)
plotModelScores(LA4_XO_FC_model)
```
Link Extension :
```{r}
LA4_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA4_XO_FC_Model_Folder,LA4_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA4_XO_FC_LinkSugg <- LA4_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA4_XO_FC_LinkSugg,n=No_rows_display))
```
### LA5:Bmp4r	-> Smad2
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,550), fig.height=6, out.extra='style=""'}
LA5_XO_FC_Model_Folder = "XO/run_XO_R345_Network_LA5_100k_2020-10-29" #Current_Model_Folder
LA5_XO_FC_Model = "XO_R345_Network_LA5_100k.mra"
LA5_XO_FC_Ext_File = "extension_XO_R345_Network_LA5_100k+red.csv"
LA5_XO_FC_model = rebuildModel(file.path(Modeling_Dir,LA5_XO_FC_Model_Folder,LA5_XO_FC_Model), XO_FC_midas)
plotModelGraph(LA5_XO_FC_model)
#plotModelParameters(LA5_XO_FC_model)
```
Model residual = `r round(LA5_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA5_XO_FC_model)
plotModelScores(LA5_XO_FC_model)
```
Link Extension :
```{r}
LA5_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA5_XO_FC_Model_Folder,LA5_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA5_XO_FC_LinkSugg <- LA5_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA5_XO_FC_LinkSugg,n=No_rows_display))
```
### LA6:Jak->Gsk3
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,550), fig.height=6, out.extra='style=""'}
LA6_XO_FC_Model_Folder = "XO/run_XO_R345_Network_LA6_100k_2020-10-29" #Current_Model_Folder
LA6_XO_FC_Model = "XO_R345_Network_LA6_100k.mra"
LA6_XO_FC_Ext_File = "extension_XO_R345_Network_LA6_100k+red.csv"
LA6_XO_FC_model = rebuildModel(file.path(Modeling_Dir,LA6_XO_FC_Model_Folder,LA6_XO_FC_Model), XO_FC_midas)
plotModelGraph(LA6_XO_FC_model)
#plotModelParameters(LA6_XO_FC_model)
```
Model residual = `r round(LA6_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA6_XO_FC_model)
plotModelScores(LA6_XO_FC_model)
```
Link Extension :
```{r}
LA6_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA6_XO_FC_Model_Folder,LA6_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA6_XO_FC_LinkSugg <- LA6_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA6_XO_FC_LinkSugg,n=No_rows_display))
```
### LA7:Actr->Ras
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,550), fig.height=6, out.extra='style=""'}
LA7_XO_FC_Model_Folder = "XO/run_XO_R345_Network_LA7_100k_2020-10-29" #Current_Model_Folder
LA7_XO_FC_Model = "XO_R345_Network_LA7_100k.mra"
LA7_XO_FC_Ext_File = "extension_XO_R345_Network_LA7_100k+red.csv"
LA7_XO_FC_model = rebuildModel(file.path(Modeling_Dir,LA7_XO_FC_Model_Folder,LA7_XO_FC_Model), XO_FC_midas)
plotModelGraph(LA7_XO_FC_model)
#plotModelParameters(LA7_XO_FC_model)
```
Model residual = `r round(LA7_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA7_XO_FC_model)
plotModelScores(LA7_XO_FC_model)
```
Link Extension :
```{r}
LA7_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA7_XO_FC_Model_Folder,LA7_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA7_XO_FC_LinkSugg <- LA7_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA7_XO_FC_LinkSugg,n=No_rows_display))
```
### LA8:Lifr->Akt
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,550), fig.height=6, out.extra='style=""'}
LA8_XO_FC_Model_Folder = "XO/run_XO_R345_Network_LA8_100k_2020-10-29" #Current_Model_Folder
LA8_XO_FC_Model = "XO_R345_Network_LA8_100k.mra"
LA8_XO_FC_Ext_File = "extension_XO_R345_Network_LA8_100k+red.csv"
LA8_XO_FC_model = rebuildModel(file.path(Modeling_Dir,LA8_XO_FC_Model_Folder,LA8_XO_FC_Model), XO_FC_midas)
plotModelGraph(LA8_XO_FC_model)
#plotModelParameters(LA8_XO_FC_model)
```
Model residual = `r round(LA8_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA8_XO_FC_model)
plotModelScores(LA8_XO_FC_model)
```
Link Extension :
```{r}
LA8_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA8_XO_FC_Model_Folder,LA8_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA8_XO_FC_LinkSugg <- LA8_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA8_XO_FC_LinkSugg,n=No_rows_display))
```
### LA9:Gsk3->Lifr
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,550), fig.height=6, out.extra='style=""'}
LA9_XO_FC_Model_Folder = "XO/run_XO_R345_Network_LA9_100k_2020-10-30" #Current_Model_Folder
LA9_XO_FC_Model = "XO_R345_Network_LA9_100k.mra"
LA9_XO_FC_Ext_File = "extension_XO_R345_Network_LA9_100k+red.csv"
LA9_XO_FC_model = rebuildModel(file.path(Modeling_Dir,LA9_XO_FC_Model_Folder,LA9_XO_FC_Model), XO_FC_midas)
plotModelGraph(LA9_XO_FC_model)
#plotModelParameters(LA9_XO_FC_model)
```
Model residual = `r round(LA9_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA9_XO_FC_model)
plotModelScores(LA9_XO_FC_model)
```
Link Extension :
```{r}
LA9_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA9_XO_FC_Model_Folder,LA9_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA9_XO_FC_LinkSugg <- LA9_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA9_XO_FC_LinkSugg,n=No_rows_display))
```
### LA10:Jak->Bmp4r
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,550), fig.height=6, out.extra='style=""'}
LA10_XO_FC_Model_Folder = "XO/run_XO_R345_Network_LA10_100k_2020-10-30" #Current_Model_Folder
LA10_XO_FC_Model = "XO_R345_Network_LA10_100k.mra"
LA10_XO_FC_Ext_File = "extension_XO_R345_Network_LA10_100k+red.csv"
LA10_XO_FC_model = rebuildModel(file.path(Modeling_Dir,LA10_XO_FC_Model_Folder,LA10_XO_FC_Model), XO_FC_midas)
plotModelGraph(LA10_XO_FC_model)
#plotModelParameters(LA10_XO_FC_model)
```
Model residual = `r round(LA10_XO_FC_model$bestfit)`
```{r echo=FALSE, message = FALSE,warning=FALSE, out.width=c(350,350), dpi=36 , fig.height=12, out.extra='style=""'}
plotModelAccuracy(LA10_XO_FC_model)
plotModelScores(LA10_XO_FC_model)
```
Link Extension :
```{r}
LA10_XO_FC_LinkSugg = read.table(file.path(Modeling_Dir,LA10_XO_FC_Model_Folder,LA10_XO_FC_Ext_File), sep = "\t", header = TRUE)
#LA10_XO_FC_LinkSugg <- LA10_XO_FC_LinkSugg[c(1:20),-1]
PrintOut_Table(head(LA10_XO_FC_LinkSugg,n=No_rows_display))
```
## Link_Selection{.tabset .tabset-fade}
### Init
**XX : List post filter**
```{r}
INIT_XX_ext <- filter_ext_list(Init_XX_FC_LinkSugg)
PrintOut_Table(head(INIT_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
INIT_XO_ext <- filter_ext_list(Init_XO_FC_LinkSugg)
PrintOut_Table(head(INIT_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
INIT_common_links_byTot_Percentage_DelResidual <- Select_Link(INIT_XX_ext,INIT_XO_ext,3)
PrintOut_Table(head(INIT_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA1
**XX : List post filter**
```{r}
LA1_XX_ext <- filter_ext_list(LA1_XX_FC_LinkSugg)
PrintOut_Table(head(LA1_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA1_XO_ext <- filter_ext_list(LA1_XO_FC_LinkSugg)
PrintOut_Table(head(LA1_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA1_common_links_byTot_Percentage_DelResidual <- Select_Link(LA1_XX_ext,LA1_XO_ext,3)
PrintOut_Table(head(LA1_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA2
**XX : List post filter**
```{r}
LA2_XX_ext <- filter_ext_list(LA2_XX_FC_LinkSugg)
PrintOut_Table(head(LA2_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA2_XO_ext <- filter_ext_list(LA2_XO_FC_LinkSugg)
PrintOut_Table(head(LA2_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA2_common_links_byTot_Percentage_DelResidual <- Select_Link(LA2_XX_ext,LA2_XO_ext,3)
PrintOut_Table(head(LA2_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA3
**XX : List post filter**
```{r}
LA3_XX_ext <- filter_ext_list(LA3_XX_FC_LinkSugg)
PrintOut_Table(head(LA3_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA3_XO_ext <- filter_ext_list(LA3_XO_FC_LinkSugg)
PrintOut_Table(head(LA3_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA3_common_links_byTot_Percentage_DelResidual <- Select_Link(LA3_XX_ext,LA3_XO_ext,3)
PrintOut_Table(head(LA3_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA4
**XX : List post filter**
```{r}
LA4_XX_ext <- filter_ext_list(LA4_XX_FC_LinkSugg)
PrintOut_Table(head(LA4_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA4_XO_ext <- filter_ext_list(LA4_XO_FC_LinkSugg)
PrintOut_Table(head(LA4_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA4_common_links_byTot_Percentage_DelResidual <- Select_Link(LA4_XX_ext,LA4_XO_ext,3)
PrintOut_Table(head(LA4_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA5
**XX : List post filter**
```{r}
LA5_XX_ext <- filter_ext_list(LA5_XX_FC_LinkSugg)
PrintOut_Table(head(LA5_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA5_XO_ext <- filter_ext_list(LA5_XO_FC_LinkSugg)
PrintOut_Table(head(LA5_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA5_common_links_byTot_Percentage_DelResidual <- Select_Link(LA5_XX_ext,LA5_XO_ext,3)
PrintOut_Table(head(LA5_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA6
**XX : List post filter**
```{r}
LA6_XX_ext <- filter_ext_list(LA6_XX_FC_LinkSugg)
PrintOut_Table(head(LA6_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA6_XO_ext <- filter_ext_list(LA6_XO_FC_LinkSugg)
PrintOut_Table(head(LA6_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA6_common_links_byTot_Percentage_DelResidual <- Select_Link(LA6_XX_ext,LA6_XO_ext,3)
PrintOut_Table(head(LA6_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA7
**XX : List post filter**
```{r}
LA7_XX_ext <- filter_ext_list(LA7_XX_FC_LinkSugg)
PrintOut_Table(head(LA7_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA7_XO_ext <- filter_ext_list(LA7_XO_FC_LinkSugg)
PrintOut_Table(head(LA7_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA7_common_links_byTot_Percentage_DelResidual <- Select_Link(LA7_XX_ext,LA7_XO_ext,3)
PrintOut_Table(head(LA7_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA8
**XX : List post filter**
```{r}
LA8_XX_ext <- filter_ext_list(LA8_XX_FC_LinkSugg)
PrintOut_Table(head(LA8_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA8_XO_ext <- filter_ext_list(LA8_XO_FC_LinkSugg)
PrintOut_Table(head(LA8_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA8_common_links_byTot_Percentage_DelResidual <- Select_Link(LA8_XX_ext,LA8_XO_ext,3)
PrintOut_Table(head(LA8_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA9
**XX : List post filter**
```{r}
LA9_XX_ext <- filter_ext_list(LA9_XX_FC_LinkSugg)
PrintOut_Table(head(LA9_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
LA9_XO_ext <- filter_ext_list(LA9_XO_FC_LinkSugg)
PrintOut_Table(head(LA9_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
LA9_common_links_byTot_Percentage_DelResidual <- Select_Link(LA9_XX_ext,LA9_XO_ext,3)
PrintOut_Table(head(LA9_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
### LA10
**XX : List post filter**
```{r}
LA10_XX_ext <- filter_ext_list(LA10_XX_FC_LinkSugg)
PrintOut_Table(head(LA10_XX_ext, n=No_rows_display))
```
**XO : List post filter**
```{r}
# LA10_XO_ext <- filter_ext_list(LA10_XO_FC_LinkSugg)
# PrintOut_Table(head(LA10_XO_ext, n=No_rows_display))
```
**Intersection List**
```{r}
# LA10_common_links_byTot_Percentage_DelResidual <- Select_Link(LA10_XX_ext,LA10_XO_ext,3)
# PrintOut_Table(head(LA10_common_links_byTot_Percentage_DelResidual, n=No_rows_display))
```
## Summary
**Links Added and Residuals**
```{r message = FALSE, out.width=c(350,350), fig.height=5, fig.show='hold', out.extra='style=""'}
Final_Network_file <- "XX/Network_LA10.tab"
Final_Network = read.csv(file.path(Modeling_Dir,Final_Network_file), sep = "\t", header = FALSE)
colnames(Final_Network) <- c("from_node","to_node")
New_links <- Final_Network[18:nrow(Final_Network),]
New_links <- New_links %>%
unite("Link",from_node:to_node,remove = FALSE )
New_links$Link <- gsub("_","->",New_links$Link)
Model_iteration=c("Init","1","2","3","4","5","6","7","8", "9","10")
Model_iteration = factor(Model_iteration, levels =Model_iteration )
LinksAdded_p_005<- data.frame(Iteration=Model_iteration,Links=c("Init Network",New_links$Link))
```
```{r}
res_p_005_XX = c(Init_XX_FC_model$bestfit,
LA1_XX_FC_model$bestfit,
LA2_XX_FC_model$bestfit,
LA3_XX_FC_model$bestfit,
LA4_XX_FC_model$bestfit,
LA5_XX_FC_model$bestfit,
LA6_XX_FC_model$bestfit,
LA7_XX_FC_model$bestfit,
LA8_XX_FC_model$bestfit,
LA9_XX_FC_model$bestfit,
LA10_XX_FC_model$bestfit)
res_p_005_XO = c(Init_XO_FC_model$bestfit,
LA1_XO_FC_model$bestfit,
LA2_XO_FC_model$bestfit,
LA3_XO_FC_model$bestfit,
LA4_XO_FC_model$bestfit,
LA5_XO_FC_model$bestfit,
LA6_XO_FC_model$bestfit,
LA7_XO_FC_model$bestfit,
LA8_XO_FC_model$bestfit,
LA9_XO_FC_model$bestfit,
LA10_XO_FC_model$bestfit)
Links_Residuals_p_005 <- data.frame(Model_iteration,Links=c("Init Network",New_links$Link),res_p_005_XX,res_p_005_XO)
Links_Residuals_p_005 <- Links_Residuals_p_005 %>%
dplyr::mutate(res_p_005_XX=round(res_p_005_XX,2),
res_p_005_XO=round(res_p_005_XO,2))
write.csv(Links_Residuals_p_005, "Links_Residuals_p_005.csv")
PrintOut_Table(Links_Residuals_p_005)
Res_p_005_long <- Links_Residuals_p_005 %>%
pivot_longer(grep("res",colnames(Links_Residuals_p_005)),names_to = "Model", values_to = "residual")
MyCellLineColours <- c("XX" = "#fddbc7",
"res_p_05_XX" = "#f4a582",
"res_p_01_XX" = "#d6604d",
"res_p_005_XX" = "#b2182b",
"res_p_001_XX" = "#67001f",
"XO" = "#d1e5f0",
"res_p_05_XO" = "#92c5de",
"res_p_01_XO" = "#4393c3",
"res_p_005_XO" = "#2166ac",
"res_p_001_XO" = "#053061")
p <- ggplot(Res_p_005_long, aes(x=Model_iteration, y=residual, color=Model, group=Model))+
MyHTMLTheme+
geom_point(size=4)+
geom_line(size=1.5)+
scale_color_manual(values = MyCellLineColours)+
labs(x = "Model Extension : Iteration number",
y = "Model Residual\n")+
ylim(0,NA)+
geom_hline(yintercept=371, linetype="dashed", color = "black")+
theme(text=element_text(size = 16,color = "grey10"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 22))
print(p)
```
Coefficient of determination(R^2) :
```{r}
Coeff_Determination = list()
Coeff_Determination$Init_XX = Init_XX_FC_model$Rscores
Coeff_Determination$Final_XX = LA10_XX_FC_model$Rscores
Coeff_Determination$Init_XO = Init_XO_FC_model$Rscores
Coeff_Determination$Final_XO = LA10_XO_FC_model$Rscores
Coeff_Determination_df <- data.frame((sapply(Coeff_Determination,c)))
write.csv(Coeff_Determination_df, "Coeff_Determination_df.csv")
```
View(Coeff_Determination_df)
setwd("~/PHD_PROJECT_Zeba/Zeba_PhD_PAPER/MyGIT_FOLDER_for_PAPER/Sultana_etal_2022/6_SimulationResults_vs_ExpData")
library(tidyverse)
library(egg) #needed for set_panel_size
source("../7_ValidationExperiments/ValidationPlot_Functions/U_Functions_ValidationExp_Plotting.R")
Coeff_Determination <- read.csv("../4_Modeling_STASNet/2_Model_Extension/Coeff_Determination_df_Models.csv")
Coeff_Determination <- read.csv("../4_Modeling_STASNet/2_Model_Extension/Coeff_Determination_df.csv")
View(Coeff_Determination)
colnames(Coeff_Determination) <-  gsub("^X$","analyte_name",colnames(Coeff_Determination))
View(Coeff_Determination)
Coeff_Determination$analyte_name <- gsub("Gsk3","pGSK3",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Mek","pMEK",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("mTor","pmTOR",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Akt","pAKT",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Erk","pERK",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Stat3","pSTAT3",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Smad2","pSMAD2",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- factor(Coeff_Determination$analyte_name, levels = c("pAKT","pGSK3","pmTOR","pMEK","pERK","pSTAT3","pSMAD2"))
e
Coeff_Determination_long <- Coeff_Determination %>%
pivot_longer(cols= -c(analyte_name),names_to = "Model", values_to = "Coeff")
Coeff_Determination_long$Cell_type <- ifelse(grepl("XX",Coeff_Determination_long$Model), "XX","XO")
Coeff_Determination_long$Model = factor(Coeff_Determination_long$Model, levels = c("Init_XX","Final_XX","Init_XO","Final_XO"), labels = c("Init-XX","Comp-XX","Init-XO","Comp-XO"))
MyCategoryColours <- c("Init-XX"= "#dd1c77","Init-XO"="#f768a1",
"Comp-XX"= "#006d2c", "Comp-XO" = "#74c476")
MyCategoryFill <- c("Init-XX"= "#dd1c77","Init-XO"="#FFFFFF",
"Comp-XX"= "#006d2c", "Comp-XO" = "#FFFFFF")
Coeff_Determination$analyte_name <- factor(Coeff_Determination$analyte_name, levels = c("pAKT","pGSK3","pmTOR","pMEK","pERK","pSTAT3","pSMAD2"))
Coeff_Determination_long <- Coeff_Determination %>%
pivot_longer(cols= -c(analyte_name),names_to = "Model", values_to = "Coeff")
Coeff_Determination_long$Cell_type <- ifelse(grepl("XX",Coeff_Determination_long$Model), "XX","XO")
Coeff_Determination_long$Model = factor(Coeff_Determination_long$Model, levels = c("Init_XX","Final_XX","Init_XO","Final_XO"), labels = c("Init-XX","Comp-XX","Init-XO","Comp-XO"))
MyCategoryColours <- c("Init-XX"= "#dd1c77","Init-XO"="#f768a1",
"Comp-XX"= "#006d2c", "Comp-XO" = "#74c476")
MyCategoryFill <- c("Init-XX"= "#dd1c77","Init-XO"="#FFFFFF",
"Comp-XX"= "#006d2c", "Comp-XO" = "#FFFFFF")
g <- ggplot(Coeff_Determination_long, aes(x=Model, y=Coeff,color = Model, fill = Model))+
facet_grid(.~analyte_name)+
geom_bar(stat = "identity",width=0.6, position = position_dodge(width=0.2),size=1)+
scale_fill_manual(values= MyCategoryFill, labels=c("Initial Model:XX","Completed Model:XX","Initial Model:XO","Completed Model:XO"))+ # fill works only for some point shapes , Eg 21 -25
scale_color_manual(values= MyCategoryColours, labels=c("Initial Model:XX","Completed Model:XX","Initial Model:XO","Completed Model:XO"))+
ylim(-0.5,1)+
MyPaperTheme+
xlab("")+
ylab(expression(paste("Exp. data vs. model \n coeff. of determination, ", R^2)))+
theme(axis.text.x = element_blank(),
axis.text.y = element_text(angle = 0, size = 6, colour = "black",hjust = 1),
axis.ticks.x = element_blank(),
legend.position ="bottom",
legend.text = element_text(color = "black", size = 7),
legend.title = element_blank(),
legend.key.size = unit(0.25,"cm"),
strip.text.x = element_text(color='black', size=7, face = 'bold'),#set the size and bold face of panel headings of the facet grid.
panel.border = element_rect(colour = "black", fill=NA, size=0.5),
panel.spacing.x = unit(0.5, "lines")) #This is to control that space between panels horizontally
gt=set_panel_size(g,width=unit(2.0,'cm'),height=unit(2.0,'cm'))
grid.arrange(gt)
ggsave("Fig3B_Coeff_Determination.pdf", gt, dpi=300, useDingbats=FALSE, path = "./OUTPUT_PAPER",width = 25, height = 20, units = "cm")
g <- ggplot(Coeff_Determination_long, aes(x=Model, y=Coeff,color = Model, fill = Model))+
facet_grid(.~analyte_name)+
geom_bar(stat = "identity",width=0.6, position = position_dodge(width=0.2),size=1)+
scale_fill_manual(values= MyCategoryFill, labels=c("Initial Model:XX","Completed Model:XX","Initial Model:XO","Completed Model:XO"))+ # fill works only for some point shapes , Eg 21 -25
scale_color_manual(values= MyCategoryColours, labels=c("Initial Model:XX","Completed Model:XX","Initial Model:XO","Completed Model:XO"))+
ylim(-0.5,1)+
MyPaperTheme+
xlab("")+
ylab(expression(paste("Exp. data vs. model \n coeff. of determination, ", R^2)))+
theme(axis.text.x = element_blank(),
axis.text.y = element_text(angle = 0, size = 6, colour = "black",hjust = 1),
axis.ticks.x = element_blank(),
legend.position ="bottom",
legend.text = element_text(color = "black", size = 7),
legend.title = element_blank(),
legend.key.size = unit(0.25,"cm"),
strip.text.x = element_text(color='black', size=7, face = 'bold'),#set the size and bold face of panel headings of the facet grid.
panel.border = element_rect(colour = "black", fill=NA, size=0.5),
panel.spacing.x = unit(0.5, "lines")) #This is to control that space between panels horizontally
gt=set_panel_size(g,width=unit(1.8,'cm'),height=unit(2.0,'cm'))
grid.arrange(gt)
ggsave("Fig3B_Coeff_Determination.pdf", gt, dpi=300, useDingbats=FALSE, path = "./OUTPUT_PAPER",width = 25, height = 20, units = "cm")
setwd("~/PHD_PROJECT_Zeba/Zeba_PhD_PAPER/MyGIT_FOLDER_for_PAPER/Sultana_etal_2022/6_SimulationResults_vs_ExpData")
library(tidyverse)
library(egg) #needed for set_panel_size
source("../7_ValidationExperiments/ValidationPlot_Functions/U_Functions_ValidationExp_Plotting.R")
Coeff_Determination <- read.csv("../4_Modeling_STASNet/2_Model_Extension/Coeff_Determination_df.csv")
colnames(Coeff_Determination) <-  gsub("^X$","analyte_name",colnames(Coeff_Determination))
Coeff_Determination$analyte_name <- gsub("Gsk3","pGSK3",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Mek","pMEK",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("mTor","pmTOR",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Akt","pAKT",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Erk","pERK",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Stat3","pSTAT3",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- gsub("Smad2","pSMAD2",Coeff_Determination$analyte_name)
Coeff_Determination$analyte_name <- factor(Coeff_Determination$analyte_name, levels = c("pAKT","pGSK3","pmTOR","pMEK","pERK","pSTAT3","pSMAD2"))
Coeff_Determination_long <- Coeff_Determination %>%
pivot_longer(cols= -c(analyte_name),names_to = "Model", values_to = "Coeff")
Coeff_Determination_long$Cell_type <- ifelse(grepl("XX",Coeff_Determination_long$Model), "XX","XO")
Coeff_Determination_long$Model = factor(Coeff_Determination_long$Model, levels = c("Init_XX","Final_XX","Init_XO","Final_XO"), labels = c("Init-XX","Comp-XX","Init-XO","Comp-XO"))
MyCategoryColours <- c("Init-XX"= "#dd1c77","Init-XO"="#f768a1",
"Comp-XX"= "#006d2c", "Comp-XO" = "#74c476")
MyCategoryFill <- c("Init-XX"= "#dd1c77","Init-XO"="#FFFFFF",
"Comp-XX"= "#006d2c", "Comp-XO" = "#FFFFFF")
g <- ggplot(Coeff_Determination_long, aes(x=Model, y=Coeff,color = Model, fill = Model))+
facet_grid(.~analyte_name)+
geom_bar(stat = "identity",width=0.6, position = position_dodge(width=0.2),size=1)+
scale_fill_manual(values= MyCategoryFill, labels=c("Initial Model:XX","Completed Model:XX","Initial Model:XO","Completed Model:XO"))+ # fill works only for some point shapes , Eg 21 -25
scale_color_manual(values= MyCategoryColours, labels=c("Initial Model:XX","Completed Model:XX","Initial Model:XO","Completed Model:XO"))+
ylim(-0.5,1)+
MyPaperTheme+
xlab("")+
ylab(expression(paste("Exp. data vs. model \n coeff. of determination, ", R^2)))+
theme(axis.text.x = element_blank(),
axis.text.y = element_text(angle = 0, size = 6, colour = "black",hjust = 1),
axis.ticks.x = element_blank(),
legend.position ="bottom",
legend.text = element_text(color = "black", size = 7),
legend.title = element_blank(),
legend.key.size = unit(0.25,"cm"),
strip.text.x = element_text(color='black', size=7, face = 'bold'),#set the size and bold face of panel headings of the facet grid.
panel.border = element_rect(colour = "black", fill=NA, size=0.5),
panel.spacing.x = unit(0.5, "lines")) #This is to control that space between panels horizontally
gt=set_panel_size(g,width=unit(1.95,'cm'),height=unit(2.0,'cm'))
grid.arrange(gt)
ggsave("Fig3B_Coeff_Determination.pdf", gt, dpi=300, useDingbats=FALSE, path = "./OUTPUT_PAPER",width = 25, height = 20, units = "cm")
